<html>
  <head>
    <title>Constrain Rewriter Sandbox</title>

    <link type="text/css" rel="stylesheet" href="/sandbox/style.css" />
  </head>
  <body>
    <div class="menu">
      <div class="title">Constraint Rewriter Sandbox</div>
    </div>

    <div class="row main">
    <div class="column left">

      <div class="panel constraint" >
	<h2>Constraints</h2>
        <p>Use <code>&lt;SESSION_ID&gt;</code> for the 'mu-session-id' header.</p>
        <p>Graphs should be variables (use VALUES or BIND when necessary).</p>
        <h3>Read Constraint</h3>
	<textarea class="constraint" id="read-constraint">
prefix g: <http://mu.semte.ch/school/graphs/>
prefix foaf: <http://xmlns.com/foaf/0.1/>

CONSTRUCT {
  ?a ?b ?c
}
WHERE {
  GRAPH ?graph { 
    ?a ?b ?c .
    ?a a ?type
  }
  VALUES (?graph ?type) {
    (g:classes school:Class) 
    (g:people foaf:Person) 
  }
}</textarea> 

</div>
      <div class="panel constraint">
	<h3>Write Constraint <small><input checked=true type="checkbox" id="read-write"/>Same as read constraint</small></h3>
	<textarea class="constraint" id="write-constraint" disabled=true>
        </textarea>
      </div>
      <div class="panel">
	<h2>Optimizations</h2>
	<h3>Functional properties</h3><p> <input type="text" id="fprops" value="rdf:type"/></p>
      </div>
      <div class="panel auth">
  <h2>Authorization and Login</h2>
  <pre>
INSERT DATA {
  GRAPH &lt;http://mu.semte.ch/authorization&gt; {
</pre>
  <textarea class="auth" id="authorization-insert">
<user0> <loggedInSesson> "root-session".
<user0> <isRoot> true.

<user1> <loggedInSession> "user01-session".
<user1> <isUser> <http://mu.semte.ch/school/123>.

<user2> <loggedInSession> "user02-session".
<user1> <isUser> <http://mu.semte.ch/school/456>.
</textarea>
<pre>
  }
}</pre>
</div>
</div>
<div class="column right">
  <div class="row generate">
    <div class="column ">
      <div class="panel">
        <h2>Generate Model</h2>
        <p><button id="generate">Generate Model</button>  with <code>&lt;SESSION_ID&gt; = "root-session"</code>
          <a id="preview" href="/preview">Preview Model &raquo;</a>
        </p>
      </div> <!-- .panel -->
    </div>   <!-- .column.half -->
    <br style="clear"/>  
  </div>

  <div class="row">
    <div class="column half">
      <div class="panel">
        <h2>Queries</h2>
        <p>Using SESSION_ID <select id="session-id"><option>root-session</option><option>user01-session</option><option>user02-session</option></select></p>
      </div>
    </div>
    <br class="clear"/>
  </div>

  <div class="row">
    <div class="column half">
      <div class="panel query">
        <h3>Query <small><button name="rewrite" id="rewrite">Rewrite</button></small></h3>
        <textarea id="query">
SELECT *
WHERE {
  ?s ?p ?o
}
        </textarea>
      </div>
    </div>

    <div class="column half">
      <div class="panel result">
        <h3>Rewritten Query <small><button name="run" id="run" disabled=true>Run</button></small></h3>
        <div class="panel-box">
          <pre id="result">
          </pre>
          <div id="annotations-box">
            <h3>Query Annotations</h3>
            <ul id="annotations"></ul>
            <h3>Queried Annotations</h3>
            <ul id="queried-annotations"></ul>
          </div>
        </div><!-- .panel-box -->
      </div><!-- .panel.result -->
    </div>
    <br class="clear"/>
  </div>
  
  <div class="panel results">
    <h2>Query Results</h2>
    <textarea id="results" disabled=true></textarea>
  </div>
</div>

<br class="clear"/>
</div>
</div>
<script type="text/javascript" src="/sandbox/sandbox.js"></script>
</body>
</html>

